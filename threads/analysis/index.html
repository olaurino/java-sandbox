<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia at 2015-10-22 
 | Rendered using Apache Maven Fluido Skin 1.4
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="Date-Revision-yyyymmdd" content="20151022" />
    <meta http-equiv="Content-Language" content="en" />
    <title>java-sandbox &#x2013; <a name="top"></a> Analyzing SED Data in Iris</title>
    <link rel="stylesheet" href="../../css/apache-maven-fluido-1.4.min.css" />
    <link rel="stylesheet" href="../../css/site.css" />
    <link rel="stylesheet" href="../../css/print.css" media="print" />

      
    <script type="text/javascript" src="../../js/apache-maven-fluido-1.4.min.js"></script>

    
                  </head>
        <body class="topBarDisabled">
          
    
    
        
    
        
    <a href="https://github.com/olaurino/sandbox">
      <img style="position: absolute; top: 0; left: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_left_orange_ff7600.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                                  <a href="../../" id="bannerLeft">
                                                                                                <img src="../../imgs/Iris_logo_padding.png"  alt="Chandra CXC"/>
                </a>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
                    
                  <li id="publishDate">Last Published: 2015-10-22
                      <span class="divider">|</span>
                   </li>
                  <li id="projectVersion">Version: 1.0-SNAPSHOT
                      </li>
                      
                
                    
      
                                    
    <li class="pull-right">
                      <a href="http://cxc.cfa.harvard.edu" class="externalLink" title="Chandra CXC">
        Chandra CXC</a>
      </li>

                    </ul>
      </div>

            
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
                    
                <ul class="nav nav-list">
                    <li class="nav-header">Iris</li>
                              
      <li>
  
                          <a href="../../index.html" title="Homepage">
          <span class="none"></span>
        Homepage</a>
            </li>
                              <li class="nav-header">Introduction</li>
                              
      <li>
  
                          <a href="../../intro/index.html" title="About">
          <span class="none"></span>
        About</a>
            </li>
                
      <li>
  
                          <a href="../../intro/features.html" title="Features">
          <span class="none"></span>
        Features</a>
            </li>
                
      <li>
  
                          <a href="../../intro/future.html" title="Future">
          <span class="none"></span>
        Future</a>
            </li>
                              <li class="nav-header">Download Iris</li>
                              
      <li>
  
                          <a href="../../download/index.html" title="Download & Installation">
          <span class="none"></span>
        Download & Installation</a>
            </li>
                
      <li>
  
                          <a href="../../download/smoke_tests.html" title="Smoke Test">
          <span class="none"></span>
        Smoke Test</a>
            </li>
                
      <li>
  
                          <a href="../../bugs/smoke.html" title="Troubleshooting">
          <span class="none"></span>
        Troubleshooting</a>
            </li>
                              <li class="nav-header">Documentation</li>
                                                                                                                                                                                                                                
      <li>
  
                          <a href="../../guide.html" title="How-To Guide">
          <span class="icon-chevron-right"></span>
        How-To Guide</a>
                  </li>
                
      <li>
  
                          <a href="../../bugs/index.html" title="Bugs & Caveats">
          <span class="none"></span>
        Bugs & Caveats</a>
            </li>
                
      <li>
  
                          <a href="../../faq/index.html" title="FAQs">
          <span class="none"></span>
        FAQs</a>
            </li>
                
      <li>
  
                          <a href="../../releasenotes/index.html" title="Release Notes">
          <span class="none"></span>
        Release Notes</a>
            </li>
                              <li class="nav-header">References</li>
                              
      <li>
  
                          <a href="../../references/models.html" title="Iris Models">
          <span class="none"></span>
        Iris Models</a>
            </li>
                
      <li>
  
                          <a href="../../references/importer_files.html" title="Supported File Formats">
          <span class="none"></span>
        Supported File Formats</a>
            </li>
                
      <li>
  
                          <a href="../../publications/index.html" title="Publications">
          <span class="none"></span>
        Publications</a>
            </li>
                              <li class="nav-header">Project Documentation</li>
                                                                                                                                                                                            
      <li>
  
                          <a href="../../project-info.html" title="Project Information">
          <span class="icon-chevron-right"></span>
        Project Information</a>
                  </li>
                                                                  
      <li>
  
                          <a href="../../project-reports.html" title="Project Reports">
          <span class="icon-chevron-right"></span>
        Project Reports</a>
                  </li>
            </ul>
                
                    
                            <form id="search-form" action="https://www.google.com/search" method="get" >
    
  <input value="http://olaurino.github.io/java-sandbox/" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script type="text/javascript" src="https://www.google.com/coop/cse/brand?form=search-form"></script>
          
          <hr />

           <div id="poweredBy">
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="builtBy" alt="Built by Maven" src="../../images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
                
        <div id="bodyColumn"  class="span10" >
                                  
            <h1><a name="top"></a> Analyzing SED Data in Iris</h1>
<hr />
<div class="section">
<h2><a name="Overview"></a><a name="overview"></a> Overview</h2>
<div class="section">
<div class="section">
<h4><a name="Synopsis:"></a>Synopsis:</h4>
<p>In this thread we step through an example Iris session in which the Spectral Energy Distribution (SED) of the FSRQ (flat-spectrum radio quasar) blazar BZQ J2129-1538 is analyzed, to represent the typical path one would take through the tool in order to build, analyze, and save a SED to file. We string together the components of the [Iris How-to Guide][guide] in order to integrate the individual features and capabilities of Iris into one, big picture.</p>
<p><b>Last Update:</b> 07 May 2015 - Updated for Iris 2.1 beta.</p>
<hr /></div></div>
<div class="section">
<h3><a name="Contents"></a><a name="toc"></a> Contents</h3>

<ul>
  
<li><b><a href="index.html#entry">Loading SED Data into Iris</a></b>
  
<ul>
    
<li><a href="index.html#from_NED">Importing SED Data from NED</a></li>
    
<li><a href="index.html#from_file">Uploading SED Data from File</a></li>
    
<li><a href="index.html#convert">Converting SED Data to a Supported Format</a></li>
  </ul></li>
  
<li><b><a href="index.html#plot">Visualizing SED Data</a></b>
  
<ul>
    
<li><a href="index.html#coplot">Plotting Multi-segment SEDs</a></li>
    
<li><a href="index.html#metadata">Accessing SED Metadata</a></li>
    
<li><a href="index.html#edit">Filtering SED Data</a></li>
    
<li><a href="index.html#shift">Shifting the SED</a></li>
    
<li><a href="index.html#change_units">Changing Graph Units</a></li>
  </ul></li>
  
<li><b><a href="index.html#model_fit">Modeling and Fitting SED Data</a></b>
  
<ul>
    
<li><a href="index.html#model">Defining Model Expressions</a></li>
    
<li><a href="index.html#pars">Setting Model Parameter Values</a></li>
    
<li><a href="index.html#stat">Choosing Fit Statistic and Method</a></li>
    
<li><a href="index.html#fit">Fitting</a></li>
  </ul></li>
  
<li><b><a href="index.html#save">Saving the Session</a></b>
  
<ul>
    
<li><a href="index.html#save_data">Saving SED Data to File</a></li>
    
<li><a href="index.html#save_session">Saving Fitted Models</a></li>
  </ul></li>
  
<li><b><a href="index.html#history">History</a></b></li>
</ul>
<hr /></div></div>
<div class="section">
<h2><a name="Loading_SED_Data_into_Iris"></a><a name="entry"></a> Loading SED Data into Iris</h2>
<p>In order to visualize an SED of an astronomical object across a wide range of wavelengths, multiple SED segments from various locations must be gathered and co-plotted; Iris features multiple entry points for SED data to facilitate this process. You can load data files from your local disk into Iris, or import SED data directly from the photometry archives of the NASA Extragalactic Database (NED). Independent of how each data set is loaded and from where, Iris can simultaneously plot multiple SED segments together in the main display.</p>
<p>In this thread, we will import two SED segments of BZQJ2129-1538 for analysis in Iris: one from the NED SED archives, and the other from file on disk.</p>
<div class="section">
<h3><a name="Importing_SED_Data_from_NED"></a><a name="from_ned"></a> Importing SED Data from NED</h3>
<p>Let us start by launching Iris from the command line:</p>

<div class="source">
<div class="source"><pre class="prettyprint">% /bin/bash   # do this for C-shell users ONLY

$ source activate iris
$ iris
</pre></div></div>
<p><img src="imgs/iris_desktop_small.jpg" alt="Iris Desktop screenshot" /></p>
<p>We can choose to import SED data directly from NED via either the Get an SED from the NED Service option in the Iris <i>Load File</i> or <i>Load NED SED</i> icon on the Iris desktop. This feature allows you to search the NED photometry database by object name to return the available SED data for that object.</p>
<p>So let&#x2019;s go ahead and import the BZQJ2129-1538 SED directly from NED. We enter the identifier &#x201c;bzqj2129-1538&#x201d; in the Target Name field, and then click Import NED SED to automatically display the SED available for this object in the Iris Visualizer.</p>
<p><a href="./imgs/import_ned_sed_v2.png"><img src="./imgs/import_ned_sed_v2_small.jpg" alt="NED SED importer screenshot" /></a> <a href="./imgs/bzqj_first_uploaded_square.png"><img src="./imgs/bzqj_first_uploaded_square_small.jpg" alt="BZQJ2129-1538" /></a></p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Uploading_SED_Data_from_File"></a><a name="from_file"></a> Uploading SED Data from File</h3>
<p>An SED data file for an object of interest can be loaded into Iris simply by starting the application and selecting the Load File icon on the Iris dekstop. If the file comes in a format which is not natively supported by Iris - i.e. a file that is not <a class="externalLink" href="http://www.ivoa.net/Documents/REC/DM/SpectrumDM-20071029.html">IVOA-compliant</a> FITS or VOTable - then it must first be converted to a supported format in the SED Builder interface before it can be displayed in the Iris Visualizer. You can learn more about the file formats recognized by the SED Builder on the Iris [Supported File Formats][importer_files] page, and refer to the <a href="../importer/">Building and Managing SEDs</a> section of the Iris How-to Guide to learn how to use the SED Builder to convert data for display in Iris.</p>
<p>Looking at the NED SED of BZQ J2129-1538, we notice a large gap of data points in the infrared regime (from around 10^11^ to 10^14^ Hz). We will fill in a part of this gap using WISE data of this object in ASCII format on file. Download <tt>WISE.bzqj2129-1538.dat</tt> to get the photometric data. The first column of the file contains the wavelength in Angstroms, and the second and third contain the flux density and corresponding error values, respectively, in ergs/s/cm2/Angstrom.</p>
<p>Let&#x2019;s add the WISE data onto our NED SED of BZQ J2129-1538. Under the &#x201c;Segments&#x201d; section in the SED Builder window, click the green plus-sign that says &#x201c;Load File&#x201d;. At the top of the &#x201c;Load an input File&#x201d; window, we click &#x201c;Location on Disk&#x201d;, browse for <tt>WISE.bzqj2129-1538.dat</tt>, select &#x201c;ASCII Table&#x201d; from the menu of file format options, and then click &#x201c;Load Spectrum/SED&#x201d;.</p>
<p><a href="./imgs/load_ascii_data_v2.png"><img src="./imgs/load_ascii_data_v2_small.jpg" alt="Load SED from file screenshot" /></a></p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Converting_SED_Data_to_a_Supported_Format"></a><a name="convert"></a> Converting SED Data to a Supported Format</h3>
<p>Since we would like to analyze a photometric data segment which we have stored in a format not natively supported by Iris, we must configure the file in the Iris SED Builder interface before it may be displayed in the Iris Visualizer for analysis. This involves starting Iris and loading the data file into the tool; entering various pieces of information about the file format so that the tool can convert from the unsupported to a supported format; and then saving the converted data as a new SED segment in the SED Builder, where it may also be saved to file. The converted segment may be saved to a separate file, or may be added to other SED segments to form an aggregate SED. This is what we will do for the BZQ J2129-1538 SED: form an aggregate SED with the WISE and NED SED data in the SED Builder to analyze.</p>
<p><tt>WISE.bzqj2129-1538.dat</tt> is in a non-standard format, so we are brought to the Import Setup Frame window of the SED Builder in order to specify which columns in the input ASCII table correspond to the X axis, Y axis, and Y axis error arrays. (The other, optional fields may also be filled in; refer to the <a href="../../threads/importer/index.html" title="Building and Managing SEDs">&#x201c;Building and Managing SEDs&#x201d;</a> section of the [Iris How-to Guide][guide] for details and instruction.)</p>
<p><a href="./imgs/convert_ascii_data_v2.png"><img src="./imgs/convert_ascii_data_v2_window.png" alt="Conversion setup screenshot" /></a></p>
<p>Here, we have &#x2018;told&#x2019; Iris that the first column in our input data file corresponds to the spectral coordinate axis and contains wavelength values in Angstrom units; and likewise, that the second column contains flux density values in ergs/s/cm2/Angstrom units. Finally, we specify that the errors on the flux density values are contained in the third column of our input file (as opposed to being unknown, or of a constant value).</p>
<p>If we had more ASCII files to convert and add to our SED, we would save this conversion configuration to a so-called &#x201c;setup&#x201d; file by selecting the &#x201c;Save Setup&#x201d; option. This setup file would allow us to convert many data files in the same unsupported format from the command line, non-interactively; i.e., so that you do not have to re-create the same conversion setup within the GUI for each file (see <a href="../importer/index.html#cli">Creating a Setup File</a> for more information about configuring setup files).</p>
<p>Now, we click &#x201c;Add Segment to SED&#x201d;, and see that the WISE data is automatically co-plotted with the NED SED, and that the WISE segment (segment with 4 data points) has been added to the &#x201c;Segments&#x201d; list in the SED Builder window. The two segments are plotted in different colors (WISE is black, NED is red) to help us visualize the separate segments.</p>
<p><a href="./imgs/bzqj_to_segments_coplotted_v2.png"><img src="./imgs/bzqj_to_segments_coplotted_v2_small.jpg" alt="Coplot screenshot" /></a></p>
<p>We can also save the WISE data segment in VOTable or FITS format by highlighting the segment in the SED Builder window, and clicking the &#x201c;Save&#x201d; button in the <i>Segements</i> section. We could also save the aggregate SED by highlighting the SED name in the left-column, and clicking &#x201c;Save&#x201d; from the top bar of the SED Builder window. You can choose to save the SED as-is or as a Single Table. The Single Table option removes all metadata, saving only the spectral coordinates, fluxes, and flux errors (a low-maintenance format for external use in other programs, but this means that the next time you load the Single Table in Iris, Iris will not be able to distinguish the two SED segments). If you wish to maintain the individual SED segments for a later session in Iris, do not check &#x201c;Single Table&#x201d;.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div></div>
<div class="section">
<h2><a name="Visualizing_SED_Data"></a><a name="plot"></a> Visualizing SED Data</h2>
<p>The Iris Visualizer is an adaptation of the [Specview][specview]) spectral visualization and analysis GUI, and as a result offers several of the data display preferences of Specview. Multiple SED data segments or photometric points may be plotted simultaneously in the Iris main display, tables of metadata and data arrays may be accessed and filtered, and the attributes of several components of the display may be customized to suit your preferences.</p>
<div class="section">
<h3><a name="Plotting_Multi-segment_SEDs"></a><a name="coplot"></a> Plotting Multi-segment SEDs</h3>
<p>In order to view both of the SED data segments of BZQ J2129-1538 simultaneously in the Iris display, we simply load and configure both segments in the SED Builder, as outlined above; multiple segments of an aggregate SED (those listed in the &#x201c;Segments&#x201d; field of the SED Builder) always display together.</p>
<p>Separate SEDs may also be maintained in a given Iris session, where only one is displayed at a time, by loading each new SED via the the &#x201c;New&#x201d; button at the top of the SED Builder window, as opposed to adding new segments in the &#x201c;Segments&#x201d; area (see the &#x201c;<a href="../importer/index.html#separate">Building and Managing SEDs</a>&#x201d; section of the Iris How-to Guide for details). If you wish to view two separate SEDs at the same time, you can use the &#x201c;Co-plot&#x201d; function under <i>Display</i> in the Iris visualizer tool bar.</p>
<p>For display purposes, let&#x2019;s change the name of the SED from &#x201c;Sed&#x201d;, the default name, to &#x201c;BZQ J2129-1538&#x201d; by typing the new name into the &#x201c;ID&#x201d; field near the top of the SED Builder window. Renaming SEDs with meaningful titles can be helpful when analyzing numerous SEDs in an Iris session.</p>
<p><a href="./imgs/change_sed_name.png"><img src="./imgs/change_sed_name_small.jpg" alt="change-SED-name screenshot" /></a></p>
<p>It is important to note that when multiple SED data segments are plotted together, the spectral data from each segment is not combined, coadded, or spliced in memory in any way. The raw data from the multiple input spectra is completely preserved in the resulting combination.</p>
<p>Finally, note that one of the loaded data segments displays in magenta-colored symbols; this indicates that the data have associated zero-value errors. Data points with zero-value errors are ignored in the model fitting in Iris (see the <a href="../../faq/zero_errs.html">Iris FAQs</a> for details).</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Accessing_SED_Metadata"></a><a name="metadata"></a> Accessing SED Metadata</h3>
<p>Clicking the &#x201c;Metadata&#x201d; button in the upper-right corner of the Iris display opens a window containing three separate tabs of information, the first displaying the metadata associated with each SED data point in the plot, the second showing data about each SED segment, and the third listing independent and dependent data arrays defining the plot.</p>
<p><img src="./imgs/metadata1_small.jpg" alt="Iris GUI snapshot" /> <img src="./imgs/metadata2_small.jpg" alt="Iris GUI snapshot" /></p>
<p>When available, the Metadata tab includes many useful pieces of information about the data points currently displayed. When a SED is imported from NED, for example, the metadata includes such things as the bibliographic reference code for each data point, the spectral range covered by instrument used to obtain data point, data point uncertainty and flux values as they are published, data point significance values, among others For the WISE data, only the data point ID and SED name is returned since our data files were loaded without associated metadata.</p>
<p>The Segment metadata tab displays metadata that is common to the whole SED segment. We find similar information that&#x2019;s in the Metadata tab, amongst other reference information. We will not be using the segment metadata for this analysis.</p>
<p>The Data tab shows the X (Spectral Axis) and Y (Flux Axis)coordinate values of each SED data point in the Iris display, reflecting the values as they were imported into Iris from NED or uploaded from a file on your hard disk - not what is currently plotted in the Iris display (in the event that you changed the units of the data plot within the display). For example, if the data were uploaded in Jansky flux units versus frequency in Hertz, but then you change the display units to ergs/s/cm2/Angstrom versus Angstrom, the data point values returned will be in Jansky flux units and Hertz.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Filtering_SED_Data"></a><a name="edit"></a> Filtering SED Data</h3>
<p>The Metadata function in the Iris main display also allows us to filter the current SED so that selected (or unselected) points appear suppressed or &#x2018;grayed out&#x2019;. This can be done by selecting the rows corresponding to these points in the Metadata tab, and then clicking &#x201c;View un-selected&#x201d; at the bottom of that window. In the display, the points selected in the Metadata window will appear fainter than the unselected points.</p>
<p>Let&#x2019;s remove all photometric points without uncertainties. Here, we have masked photometric points without any reported errors using the Boolean filter in the Data tab. We type &#x201c;f: &gt; 0&#x201d; into the filter (if a cell should have a numeric value but is left empty, the cell will be selected in this way). In the resulting figure below, the diamonds (representing the points with no errors) are lighter than the rest of the points.</p>
<p><img src="./imgs/boolean_filter_viewer_small.jpg" alt="Iris GUI snapshot" /></p>
<p>Selected data points may even be extracted into a whole new SED by clicking &#x201c;Extract&#x201d; after making the desired row selections in the Metadata window. This will open a new SED in the SED Builder window named &#x201c;FilterSED&#x201d; - an ID which you can change - which will display in the Iris Visualizer. Let&#x2019;s extract the filtered BZQ J2129-1538 SED from the Data tab, so that we only have the data with associated uncertainties. Note that the colors switched between the WISE and NED data: WISE data is now red, and the NED data is black (this is because the SED segments are arranged alphabetically after extracting a new SED, so the colors, which translate lexicographically, also change).</p>
<p><img src="./imgs/filter_sed_v2_small.jpg" alt="Iris GUI snapshot" /></p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Shifting_the_SED"></a><a name="shift"></a> Shifting the SED</h3>
<p>We know that BZQ J2129-1538 is at redshift z=3.268 <a class="externalLink" href="http://arxiv.org/abs/astro-ph/0105203">(2001A&amp;A&#x2026;375&#x2026;739D)</a>. Before analyzing our data any further, let&#x2019;s shift the SED to restframe. We can easily do this in Iris. Click on the <i>Shift, Interpolate, Integrate</i> icon on the desktop. In the &#x201c;Redshift&#x201d; section of the <i>Redshift and Interpolate</i> tab, we type &#x201c;3.268&#x201d; into the &#x201c;Initial redshift&#x201d; field and &#x201c;0&#x201d; into &#x201c;Move to redshift&#x201d;, and finally select &#x201c;Create new SED&#x201d;. The blueshifted SED will automatically display in the Iris Visualizer.</p>
<p><i>Note that the indivual SED segments are combined into one, aggregate SED, and that the NED metadata is not retained.</i></p>
<p><img src="./imgs/shift_sed_v2.png" alt="Redshift and Interpolate screenshot" /></p>
<p>We have two very similar (and ambiguous) names for the filtered and filtered+shifted SEDs. We can change their names from the SED Builder window. Let&#x2019;s rename them to something more meaningful: &#x201c;BZQ J2129-1538 FilterSed&#x201d; and &#x201c;BZQ J2129-1538 FilterSed (z=0)&#x201d;. Note that two SEDs loaded into the SED Builder cannot chare the same ID name.</p>
<p>Let&#x2019;s observe the change in shape from the observed to the rest-frame BZQ J2129-1538 SED. We click <i>Display &#x2013;&gt; Co-plot</i> on the Iris Visualizer, select &#x201c;BZQ J2129-1538&#x201d; and &#x201c;BZQ J2129-1538 FilterSed (z=0)&#x201d;, and click &#x201c;Co-plot&#x201d;. We see that the object is brighter, and the whole spectrum shifted to higher frequencies, as expected.</p>
<p><img src="./imgs/shifted_sed_v2_plotted_small.jpg" alt="Coplot screenshot" /></p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Changing_Graph_Units"></a><a name="change_units"></a> Changing Graph Units</h3>
<p>The axes units automatically displayed in the Iris Visualizer might not be the units of choice. We can change the units on the upper-right corner of the Iris visualizer. We can switch between &#x201c;Flux&#x201d; and &#x201c;Flux density&#x201d; using the drop-down menu next to the Metadata browser button, and then choose the desired X- and Y-axis units from the list that will pop-up in the top-left corner of your computer screen.</p>
<p>In our case, we want to plot Jy*Hz against Hz for reasons that will be clear when we start to fit the data (see the next section). Let&#x2019;s change the Y-axis from &#x201c;Flux density&#x201d; to &#x201c;Flux&#x201d;, and choose Hz and Jy*Hz for our spectral axis and flux axis, respectively.</p>
<p><a href="./imgs/sed_change_units.png"><img src="./imgs/sed_change_units_small.jpg" alt="change-units screenshot" /></a></p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div></div>
<div class="section">
<h2><a name="Modeling_and_Fitting_SED_Data"></a><a name="model_fit"></a> Modeling and Fitting SED Data</h2>
<p>Having loaded our desired BZQ J2129-1538 SED data and set our data display preferences, we are ready to define a model expression and fit the model to the data. The resulting best-fit values for the SED model parameters, and confidence limits on them, are physically meaningful quantities which we will use in our analysis of BZQ J2129-1538.</p>
<p>We initiate the fitting process by selecting the &#x201c;Fitting Tool&#x201d; icon on the Iris desktop.</p>
<p><img src="./imgs/initiate_fitting_v2_small.jpg" alt="Iris GUI snapshot" /></p>
<p>The Iris Fitting Tool allows you to define a single or multi-component model expression, set starting model parameter values and ranges, and choose from among a list of robust fit statistics and methods. It also allows you to calculate the specified percent/sigma confidence intervals on best-fit model parameters, to assess the quality of the fit (e.g., entering &#x201c;1.6&#x201d; for 1.6-sigma, 90% confidence).</p>
<p>In the current release of Iris, <b>it is not possible to edit SED data <i>during the fitting process</i></b>, e.g., to mask any data points which have been flagged as &#x2018;bad&#x2019; and have them left out of the fit; or scale, trim, and join multiple data segments into a seamless, wide-band SED to be fit. This must all be done before the fitting session is initiated. However, Iris does support a simultaneous fit of multiple, separate SED segments.</p>
<p>*<b>Note:</b> Exiting the fitting window before clicking &#x201c;Save&#x201d; will erase all data - parameters, models, confidence limits - associated with that particular fitting session. Minimizing the fitting window and starting another fitting session with a separate SED will* not <i>erase the previous fitting session; minimized fitting sessions may be restored simply by clicking on the desired SED name in the SED Builder.</i></p>
<div class="section">
<h3><a name="Defining_Model_Expressions"></a><a name="models"></a> Defining Model Expressions</h3>
<p><b>New since Iris v1.1</b>: <i>the new </i><i>Custom Model Manager</i>* interface allows you to import into Iris your custom table, template, and Python user models, for use with the Iris Fitting Tool. Refer to the &#x201c;<a href="../fit/index.html#define_model">Modeling and Fitting SED Data</a>&#x201d; section of the Iris How-to Guide to learn how to load your own models into Iris and use them to fit SED data in Iris.*</p>
<p>Before we start fitting the data, let&#x2019;s talk about the physics of this SED, which will help us choose the right models. FSRQ blazar SEDs are dominated by two characteristic &#x201c;bumps&#x201d; in the infrared and gamma-ray regimes, as well as what&#x2019;s called the &#x201c;Big Blue Bump&#x201d; at optical/UV wavelengths. These features are thought to be caused by synchrotron emission at low frequencies, inverse-Compton (IC) radiation at high energies, and black body radiation from the accretion disk in the center of the galaxy at optical/UV wavelengths (<a class="externalLink" href="http://adsabs.harvard.edu/abs/2009ApJ...692...32D">Dermer et al. 2009</a>). It has been shown that the synchrotron and IC emission can be modeled by logarithmic parabolas. Therefore, we&#x2019;ll need two log-parabolas and an accretion disk model for the X-ray regime to the &#x201c;Components&#x201d; list for fitting.</p>
<p>We can delete the [powerlaw][powerlaw] that is in the &#x201c;Components&#x201d; list since we will not be using it. We do this by highlighting the model and selecting &#x201c;Delete&#x201d; at the bottom of the fitting window (it is not required that we delete this component if we do not wish to fit with it; it may simply be ignored when defining the model expression)</p>
<p>We click &#x201c;Add&#x201d; and double-click &#x201c;Preset Components&#x201d; to browse the full list of optical and X-ray models available from Sherpa, to find the log-parabola and accretion disk models. From this list, we make three selections: &#x201c;<a href="../../references/models.html#accretiondisk">accretiondisk</a>&#x201d; once, and &#x201c;<a href="../../references/models.html#logparabola">logparabola</a>&#x201d; twice, in order to define these as the components with which to build our full model expression. The components will appear with identifiers &#x201c;c1&#x201d;, &#x201c;c2&#x201d;, and &#x201c;c3&#x201d; in the Fit window. Having selected our model components, we can combine them into the appropriate arithmetic expression in the &#x201c;Model Expression&#x201d; field. The SED spans more than 10 decades in frequency with large regions of sparse data. Therefore, we will add the components one-by-one, freezing the parameters of the previous model each time we add a new component. We will start by fitting the synchrotron emission peak, modeled by the log-parabola, &#x201c;c2&#x201d;.</p>
<p><img src="./imgs/preset_components.png" alt="Preset model components" /> <img src="./imgs/model_components_v2_new.png" alt="Iris GUI snapshot" /></p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Setting_Model_Parameter_Values"></a><a name="pars"></a> Setting Model Parameter Values</h3>
<p>Next, we set some starting model parameter values for the fit by selecting the desired model component in the Fit window, and then &#x201c;Edit&#x201d;. Parameter values may be set in the fields of the editing window which opens, by entering the desired number and then either pressing &#x201c;Return&#x201d; on your computer keyboard or clicking &#x201c;Apply&#x201d; on the parameter window. The internal units for fitting in Iris are always in photons/s/cm^2^/Angstrom vs Angstroms, so all of the values entered into the parameter fields must be in or photons/cm^2^/Angstrom or Angstroms.</p>
<p><img src="./imgs/model_expression+params_v2.png" alt="Iris GUI snapshot" /></p>
<p>For our analysis, we choose to allow all model parameters to vary in the fit except the reference position of the log-parabolas and the accretion disk. If you wished to fix a parameter, you would uncheck the &#x201c;Fit&#x201d; box associated with that parameter. We make a guess at the peak positions of the log-parabolas and accretion disk emission (the parameter &#x201c;<tt>refer</tt>&#x201d;) by changing the spectral units to Angstroms, hovering the cursor over the points of interest in the Iris Visualizer and recording the X values (in Angstroms) in the parameter editing window. If the data points are off the sides of the plot area, click <img src="./imgs/remove_edges_plot_button.png" alt="the button with two black arrows pointing upwards on top of the Iris visualizer" /> to re-center the plot.</p>
<p>For an initial guess, we use 1500, 500,000 and 1e-3 Angstroms for the accretion disk, the synchrotron region, and the IC component, respectively. To edit the parameter values, double-click &#x201c;<a href="../../references/models.html#accretiondisk">accretiondisk</a>.c1&#x201d;, &#x201c;<a href="../../references/models.html#logparabola">logparabola</a>.c2&#x201d; and &#x201c;<a href="../../references/models.html#logparabola">logparabola</a>.c3&#x201d;, and input the initial guesses into the respective <tt>refer</tt> box.</p>
<p><a href="./imgs/edit_params_v2_new.png"><img src="./imgs/edit_params_v2_new_small.jpg" alt="Iris GUI snapshot" /></a></p>
<p>After recording the reference positions in the Edit Parameter windows, we switch back to Hz for the spectral axis. Note that we do not have to switch back to Hz for the fitting; this is just a matter of preference.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Choosing_Fit_Statistic_and_Method"></a><a name="stat"></a> Choosing Fit Statistic and Method</h3>
<p>Our final step in the preparation for fitting involves choosing a fit statistic and optimization method appropriate for our analysis. Selecting &#x201c;Fit&#x201d; in the Fit window launches a new window containing our statistic and method options.</p>
<p><img src="./imgs/statistics_optimization_v2.png" alt="Iris GUI snapshot" /></p>
<p>We see that the fit can be done with a least-squares statistic, or chi-squared (with various methods for estimating the variances used by chi-squared), or with either of two maximum likelihood statistics that are useful when the data have low numbers of counts. We choose to fit with the chi-squared statistic (chi2datavar) and Monte Carlo (moncar) optimization.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Fitting"></a><a name="fit"></a> Fitting</h3>
<p>We are now ready to fit the data using our model expression, initial model parameters values, and chosen fit statistic and method. Selecting &#x201c;Start&#x201d; in the window displaying the fit statistics, initiates the fitting process. This may take a few seconds to compute since we&#x2019;re using the Monte Carlo method.</p>
<p><a href="./imgs/bzqj_logpar_c1_fit_v2.png"><img src="./imgs/bzqj_logpar_c1_fit_v2_small.jpg" alt="Iris GUI snapshot" /></a></p>
<p>When the fit completes, we see the fitted model overlaid on the SED data in the Iris main display; a data-to-model residuals plot ; and the following fit statistics returned: the final fit statistic value, the number of data points used in the fit, the number of degrees of freedom in the fit, the null hypothesis probability value of the fit, and the reduced statistic.</p>
<p>We still have two more components to add to our model. Now, let&#x2019;s add the accretion disk model, &#x201c;c1&#x201d;. We freeze &#x201c;c2&#x201d; by highlighting the log-parabola model in the Components window, clicking &#x201c;Edit&#x201d;, un-checking all of the &#x201c;Fit&#x201d; boxes, and clicking &#x201c;Apply&#x201d;. Exit the editing window, and click &#x201c;Fit&#x201d; on the Components window. Let&#x2019;s again use the Monte-Carlo method with chi-squared statistics, and click &#x201c;Fit&#x201d;. This time, the data takes a little longer to fit; this is because our model is more complex.</p>
<p><a href="./imgs/bzqj_c1+c2_fit_v2.png"><img src="./imgs/bzqj_c1+c2_fit_v2_small.jpg" alt="two component fit" /></a></p>
<p>Now we&#x2019;ve got the optical/UV range fit. Let&#x2019;s add our last component, the IC log-parabola &#x201c;c3&#x201d;, to the model expression. Again, we freeze the accretion disk parameters, and choose Monte-Carlo + chi-squared to fit the rest of the data. Below is our final fit.</p>
<p><a href="./imgs/bzqj_c1+c2_c3.png"><img src="./imgs/bzqj_c1+c2+c3_small.jpg" alt="three component fit" /></a></p>
<p>We can calculate the confidence limits on the thawed parameters. Switching over to the Confidence tab in the window displaying fit statistics, we enter &#x201c;1.6&#x201d; in the &#x201c;sigma&#x201d; field and click &#x201c;Start&#x201d; to calculate and display the 90% confidence limits on the best-fit model parameter values resulting from the IC log-parabola, &#x201c;c3&#x201d;.</p>
<p><img src="./imgs/confidence_limits_logparc3.png" alt="confidence limits" /></p>
<p>Not completely satisfied with this initial fit, we adjust the model parameter values to better match the data, experiment with different chi-squared fit statistics, and then re-fit. We continue on in this fashion, iterating through the fit - freezing and thawing model parameters; adding or deleting models from the model expression; changing parameter values or ranges; experimenting with different fitting ranges - until we find a satisfactory model that best describes our BZQ J2129-1538 SED. Finally, we opt to write our custom model expression and best-fit parameters to file via the &#x201c;Save&#x201d; option in the Iris Fit window, in order to resurrect this particular fit in a future Iris analysis session.</p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div></div>
<div class="section">
<h2><a name="Saving_the_Session"></a><a name="save"></a> Saving the Session</h2>
<p>During a SED analysis session in Iris, it is possible to write to file the SED data arrays, as well as the customized fitting session. These output files may then be imported back into Iris for future analysis. See <a href="../../threads/save/index.html" title="Saving SED Data">Saving SED Data</a> for more details.</p>
<div class="section">
<h3><a name="Saving_SED_Data_to_File"></a><a name="save_data"></a> Saving SED Data to File</h3>
<p>The SED data open in an Iris session may be written to one or multiple FITS (.fits), VOTable (.vot), or ASCII format files (you can save each segment to a separate file, or save the multi-segment SED to one file). For example, to save our BZQ J2129-1538 SED to a FITS format file (which excludes model data values) we would select the &#x201c;Save&#x201d; option at the top of the Iris SED Builder window, to create file <tt>bzqj2129-1538_restframe.fits</tt>. We could then access our saved SED data in a future session of Iris simply by selecting the &#x201c;Load File&#x201d; icon on the Iris desktop, and browsing our disk for file <tt>bzqj2129-1538_restframe.fits</tt>.</p>
<p>We have the option to save the SED as-is &#x2013; meaning with all available metadata &#x2013; or as a Single Table. The Single Table option removes all metadata, saving only the spectral coordinates, fluxes, and flux errors (a low-maintenance format for external use in other programs, but the next time you load the Single Table in Iris, Iris will not be able to distinguish multiple SED segments). If you wish to maintain the individual SED segments for a later session in Iris, do not check &#x201c;Single Table&#x201d;. For our data, this is a non-issue, as our rest-frame SED of BZQ J2129-1538 has no metadata (remember that shifted SEDs lose all metadata); it does not matter if we check &#x201c;Single Table&#x201d;.</p>
<p><img src="./imgs/save_bzqj2129-1538_redshifted.png" alt="Saving SED Data" /></p>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div>
<div class="section">
<h3><a name="Saving_Fitted_Models"></a><a name="save_fit"></a> Saving Fitted Models</h3>
<p>Our Iris fitting session may be saved separately by being sure to select the &#x201c;Save&#x201d; option in the Iris Fit window after we have finalized our fit, and prior to exiting the fitting session with the &#x201c;Dismiss&#x201d; button in the Fit window.</p>
<p><img src="./imgs/save_model_fits_v2.png" alt="Iris GUI snapshot" /></p>
<p>This is equivalent to selecting the <i>File-&gt;Write to file</i> option, which saves the model to a CDB format file which can be read back into Iris at a later time to restore the fitting session; the <i>File-&gt;Read from File</i> menu option may be used for this purpose.</p>
<p>We may also use the <i>File -&gt; Write to text file</i> options to save the spectral model to file in a human-readable text format, either all model components, or only those active in the fit. Example output is shown below:</p>

<div class="source">
<div class="source"><pre class="prettyprint">File: BZQ J2129-1538 FilterSed (z=0)

Thu Jul 25 14:48:33 EDT 2013  Iris 2

TARGNAME: BZQ J2129-1538 FilterSed (z=0)

Model Expresion:
        c2+c1+c3

Fit parameters:
        Final fit statistic:      62198.192077727974
        Reduced statistic:        1517.0290750665361
        Probability [Q-value]:    0.0
        Degrees of freedom:       41.0
        Data points:              44
        Last function evaluation: 2507

Component 1:    accretiondisk.c1 
   F   ref  = 1500.0         angstroms                                    
   F   beta = 1.91985                                                     
   F   ampl = 3.7458314E-5                                                
   F   norm = 20000.0                                                     

Component 2:    logparabola.c2 
   F   ref  = 500000.0                                                    
   F   c1   = 0.2622442                                                   
   F   c2   = 0.161158                                                    
   F   ampl = 0.0012604317                                                

Component 3:    logparabola.c3 
   F   ref  = 0.001                                                       
       c1   = -0.24864592 (0.28186354  -0.609429)                         
       c2   = 0.15012781  (0.11571395  -0.05239018)                       
       ampl = 0.017197948 (0.021747038 NaN)                               
</pre></div></div>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<hr /></div></div>
<div class="section">
<h2><a name="History"></a><a name="history"></a>History</h2>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th>Date </th>
      
<th>Change </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td>08&#xa0;Aug&#xa0;2011 </td>
      
<td>updated for Iris Beta 2.5 </td>
    </tr>
    
<tr class="a">
      
<td>26&#xa0;Sep&#xa0;2011 </td>
      
<td>updated for Iris 1.0 </td>
    </tr>
    
<tr class="b">
      
<td>11&#xa0;Jul&#xa0;2012 </td>
      
<td>updated for Iris 1.1 </td>
    </tr>
    
<tr class="a">
      
<td>02&#xa0;Jan&#xa0;2013 </td>
      
<td>updated for Iris 1.2 </td>
    </tr>
    
<tr class="b">
      
<td>21&#xa0;Jun&#xa0;2013 </td>
      
<td>updated for Iris 2.0 </td>
    </tr>
    
<tr class="a">
      
<td>24&#xa0;Jun&#xa0;2013 </td>
      
<td>fixed editted &#x201c;ascii_setup.ini&#x201d; typo </td>
    </tr>
    
<tr class="b">
      
<td>11&#xa0;Jul&#xa0;2013 </td>
      
<td>fixed contents links. </td>
    </tr>
    
<tr class="a">
      
<td>05&#xa0;Aug&#xa0;2013 </td>
      
<td>Updated analysis example for Iris 2.0.</td>
    </tr>
    
<tr class="b">
      
<td>02&#xa0;Dec&#xa0;2013 </td>
      
<td>Updated for Iris 2.0.1 </td>
    </tr>
    
<tr class="a">
      
<td>07&#xa0;May&#xa0;2015 </td>
      
<td>Updated for Iris 2.1 beta. </td>
    </tr>
  </tbody>
</table>

<table border="0" class="table table-striped">
  <thead>
    
<tr class="a">
      
<th align="right"> </th>
    </tr>
  </thead>
  <tbody>
    
<tr class="b">
      
<td align="right">[<a href="#top">Back to top</a>]</td>
    </tr>
  </tbody>
</table>
<!-- external links -->
<!-- threads -->
<!-- extras () -->
<!-- reference files -->
<!-- CXC links -->
<!-- Navigation --></div>
                  </div>
            </div>
          </div>

    <hr/>

    <footer>
            <div class="container-fluid">
                      <div class="row-fluid">
                                      <p >Copyright &copy;                   2015.
          All rights reserved.      
                    
      </p>
                </div>

        
                </div>
    </footer>
        </body>
</html>
